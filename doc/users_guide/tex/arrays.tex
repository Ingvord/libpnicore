%%%documentation on arrays

C++ has no multidimensional array type (MDA) in its standard library. 
However, MDAs are crucial for the developmemt of scientific applications.
One of the reasons for the continuing success of languages like Fortran or Python
is their excellent support for MDAs\footnote{For Python arrays are introduced by
the {\tt numpy} package.}. The lack of an MDA type in C++
was indeed the spark that initiated the developement of \libpnicore.  Before
discussing \libpnicore s array facilities some terminology should be defined: 
%%%----------------------------------------------------------------------------
\begin{center}
\begin{tabular}{m{0.2\linewidth}p{0.7\linewidth}}
    element type (ET) &  referes to the data type of the individual elements
    stored in an MDA. For MDAs this will typically be a numeric type like an
    integer or a floating point number.\\

    rank $r$ & denotes the number of dimensions of an MDA \\

    shape $\mathbf{s}$ & is a vector of dimension $r$ whose elements are the
    number of elements along each dimension. The elements of $\mathbf{s}$ are
    denoted as $s_i$ with $i=0,\hdots,r-1$ \\
\end{tabular}
\end{center}
%%%----------------------------------------------------------------------------
The hart of \libpnicore's MDA support is the {\tt mdarray} template. 
{\tt mdarray} is extremely powerfull. Thus, using {\tt mdarray} directly to
define array types is not for the faint harted.  To simplify
the usage of multidimensional arrays the library provides three templates
derived form {\tt mdarray} which are easy to use.  
%%%----------------------------------------------------------------------------
\begin{center}
\begin{tabular}{m{0.2\linewidth}p{0.7\linewidth}}
\sdarray &  
a static arrays whose shape, rank, and element type are fixed at compile time.
\\
\farray &
element type and rank are fixed at compile time but the shape can be changed at
runtime. \\
\darray & 
a fully dynamic array type where only the element type must be known at compile
time. The rank as well as the shape can be altered at runtime\\
\end{tabular}
\end{center}
%%%----------------------------------------------------------------------------
In addition to this two basic templates there are several utility classes and
templates like
%%%----------------------------------------------------------------------------
\begin{center}
\begin{tabular}{m{0.15\linewidth}p{0.7\linewidth}}
\arrayview &  a template providing a particular view on an array (see
Sec.~\ref{sec:array:array_slicing}) \\
\arrayerasure & a type erasure that can be used with any instance of an array
template (see Chapter~\ref{chapter:type_erasure})
\end{tabular}
\end{center}
%%%----------------------------------------------------------------------------

All array types derived from {\tt mdarray} provide the following features
\begin{enumerate}
\item unary and binary arithmetics if the element type is a numeric type.
\item slicing to extract only a part of a large array
\item simple access to data elements using varidic functions
\end{enumerate}

\section{General concepts}\label{sec:array:general_concepts}
\input{tex/array_general_concepts.tex}

\section{Static arrays}\label{sec:array:static_arrays}

Static arrays are the most simple array objects provided by \libpnicore. Their
data type as well as their complete shape is determined at compile time. Though
they are not very flexible they are extremely fast as all the memory resides on
the stack. They are primarily intended to be used for small objects like 3D
vectors or matrices. 
Instantiation of such a static array goes as simple as this
\begin{minted}{cpp}
#include <pni/core/sarray.hpp>

using namespace pni::core;

sarray<float64,3,3> matrix;
\end{minted}
Internally an instance of the {\tt std::array<T,N>} template (provided by the
STL) is used to store the data. A static array can be created from every other
array type or container type (a list or a vector).

%\begin{minted}{cpp}
%//construction from initializer list
%sarray<float64,3> v1 = {1.0,2.0,3.0}; 
%//copy construction from an already existing instance 
%sarray<float64,3> v2(v1);
%
%std::vector<float64> data{-1.2,4.0,-5.4,10.8};
%sarray<float64,2,2> matrix(data);
%\end{minted}

\section{Arrays with fixed dimensions}


\section{Dynamic arrays}\label{sec:array:dynamic_arrays}

\section{Array slicing}\label{sec:array:array_slicing}

\section{Numeric arrays}\label{sec:array:numeric_arrays}

\section{The \arrayerasure\ type erasure}\label{sec:array:type_erasure}

\section{Using arrays with low level libraries}
