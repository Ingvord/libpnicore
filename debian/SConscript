Import("build_env")

from smod import DebChangelogFile

debian_dict = {"@SOURCE@":"$LIBPREFIX$LIBNAME","@MAINTAINER@":"$MAINTAINER",
               "@MAINTAINER_MAIL@":"$MAINTAINER_MAIL",
               "@PKGNAME@":"$PKGNAME","@VERSION@":"$VERSION",
               "@LIBINSTPATH@":"$LIBINSTPATH","@INCINSTPATH@":"$INCINSTPATH",
               "@DOCDIR@":"$DOCDIR"}
               
#-------------------------create control file-----------------------------------
                  
control_file = build_env.Substfile(["control.in"],SUBST_DICT=debian_dict)
build_env.NoClean(control_file)


changelog = DebChangelogFile("../","v0.0.1")
changelog.version=build_env["VERSION"]
changelog.pkg_name = build_env["PKGNAME"]
changelog.urgency = "low"
changelog.distribution = "testing"
changelog.create("changelog.in")
changelog_file = build_env.Substfile(["changelog.in"])                                  
build_env.NoClean(changelog_file)

rules_file = build_env.Substfile(["rules.in"])
build_env.NoClean(rules_file)

compat_file = build_env.Substfile(["compat.in"])
build_env.NoClean(compat_file)

lib_pkg_dirs = build_env.Substfile(target="${PKGNAME}",
                source=["libpniutils.dirs.in"],SUBST_DICT=debian_dict,
                SUBSTFILESUFFIX=".dirs")
build_env.NoClean(lib_pkg_dirs)

lib_pkg_install = build_env.Substfile(target="${PKGNAME}",
                  source=["libpniutils.install.in"],SUBST_DICT=debian_dict,
                  SUBSTFILESUFFIX=".install")
build_env.NoClean(lib_pkg_install)

dev_pkg_dirs = build_env.Substfile(target="${PKGNAME}-dev",
               source = ["libpniutils-dev.dirs.in"],
               SUBST_DICT=debian_dict,SUBSTFILESUFFIX=".dirs")
build_env.NoClean(dev_pkg_dirs)

dev_pkg_install = build_env.Substfile(target="${PKGNAMEROOT}-dev",
                  source=["libpniutils-dev.install.in"],SUBST_DICT=debian_dict,
                  SUBSTFILESUFFIX=".install")
build_env.NoClean(dev_pkg_install)                                                               

doc_pkg_dirs = build_env.Substfile(target="${PKGNAME}-doc",
                                  source=["libpniutils-doc.dirs.in"],
                                  SUBST_DICT=debian_dict,SUBSTFILESUFFIX=".dirs")
build_env.NoClean(doc_pkg_dirs)                                                                      
doc_pkg_install = build_env.Substfile(target="${PKGNAME}-doc",
                                     source=["libpniutils-doc.install.in"],
                                     SUBST_DICT=debian_dict,
                                     SUBSTFILESUFFIX=".install")
build_env.NoClean(doc_pkg_install)

build_env.Alias("debian",[control_file,compat_file,lib_pkg_dirs,lib_pkg_install,
                          dev_pkg_dirs,dev_pkg_install,
                          doc_pkg_dirs,doc_pkg_install,changelog_file,rules_file])
